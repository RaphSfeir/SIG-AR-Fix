<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=CP850" http-equiv="Content-Type" />

  <title>File: schema_caching.rb [sequel-3.41.0 Documentation]</title>

  <link type="text/css" media="screen" href="../../../rdoc.css" rel="stylesheet" />

  <script src="../../../js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file file-popup">
  <div id="metadata">
    <dl>
      <dt class="modified-date">Last Modified</dt>
      <dd class="modified-date">2012-11-14 23:59:15 +0100</dd>

      
      <dt class="requires">Requires</dt>
      <dd class="requires">
        <ul>
        
        </ul>
      </dd>
      

      
    </dl>
  </div>

  <div id="documentation">
    
    <div class="description">
      <h2>Description</h2>
      
<p>The schema_caching extension adds a few methods to <a
href="../../../Sequel/Database.html">Sequel::Database</a> that make it easy
to dump the parsed schema information to a file, and load it from that
file.  Loading the schema information from a dumped file is faster than
parsing it from the database, so this can save bootup time for applications
with large numbers of models.</p>

<p>Basic usage in application code:</p>

<pre>Sequel.extension :schema_caching

DB = Sequel.connect('...')

DB.load_schema_cache('/path/to/schema.dump')

# load model files</pre>

<p>Then, whenever the database schema is modified, write a new cached file. 
You can do that with <tt>bin/sequel</tt>'s -S option:</p>

<pre>bin/sequel -S /path/to/schema.dump postgres://...</pre>

<p>Alternatively, if you don't want to dump the schema information for all
tables, and you don't worry about race conditions, you can choose to use
the following in your application code:</p>

<pre>Sequel.extension :schema_caching

DB = Sequel.connect('...')

DB.load_schema_cache?('/path/to/schema.dump')

# load model files

DB.dump_schema_cache?('/path/to/schema.dump')</pre>

<p>With this method, you just have to delete the schema dump file if the
schema is modified, and the application will recreate it for you using just
the tables that your models use.</p>

<p>Note that it is up to the application to ensure that the dumped cached
schema reflects the current state of the database.  <a
href="../../../Sequel.html">Sequel</a> does no checking to ensure this, as
checking would take time and the purpose of this code is to take a
shortcut.</p>

<p>The cached schema is dumped in Marshal format, since it is the fastest and
it handles all ruby objects used in the schema hash.  Because of this, you
should not attempt to load the schema from a untrusted file.</p>

    </div>
    
  </div>
</body>
</html>

